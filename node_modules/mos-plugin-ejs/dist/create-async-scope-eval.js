'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _promise = require('babel-runtime/core-js/promise');

var _promise2 = _interopRequireDefault(_promise);

var _keys = require('babel-runtime/core-js/object/keys');

var _keys2 = _interopRequireDefault(_keys);

exports.default = createAsyncScopeEval;

var _babelRunAsync = require('babel-run-async');

var _babelRunAsync2 = _interopRequireDefault(_babelRunAsync);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function createAsyncScopeEval(scope, opts) {
  opts = opts || {};
  var mdVarNames = [];
  var mdVarValues = [];

  (0, _keys2.default)(scope || {}).map(function (scopeVarName) {
    mdVarNames.push(scopeVarName);
    mdVarValues.push(scope[scopeVarName]);
  });

  return (0, _babelRunAsync2.default)(function (code) {
    var funcBody = (opts.useStrict ? "'use strict';" : '') + 'return (' + code + ')';
    try {
      return Function.apply(null, mdVarNames.concat(funcBody)).apply(null, mdVarValues);
    } catch (err) {
      return _promise2.default.reject(err);
    }
  });
}
module.exports = exports['default'];