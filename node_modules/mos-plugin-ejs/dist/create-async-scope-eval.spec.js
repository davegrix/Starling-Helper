'use strict';

var _createAsyncScopeEval = require('./create-async-scope-eval');

var _createAsyncScopeEval2 = _interopRequireDefault(_createAsyncScopeEval);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var describe = require('mocha').describe;
var it = require('mocha').it;
var expect = require('chai').expect;


describe('createAsyncScopeEval', function () {
  it('should work with sync code', function () {
    return (0, _createAsyncScopeEval2.default)({ a: 1, b: 2 })('a + b').then(function (result) {
      return expect(result).to.eq(3);
    });
  });

  if (global.Promise) {
    it('should work with async code', function () {
      return (0, _createAsyncScopeEval2.default)({ a: 1, b: 2 })('Promise.resolve(a + b)').then(function (result) {
        return expect(result).to.eq(3);
      });
    });
  }

  it('should run in strict mode', function (done) {
    (0, _createAsyncScopeEval2.default)({}, { useStrict: true })('package').catch(function (err) {
      expect(err).to.be.instanceof(SyntaxError);
      expect(err.message).to.eq('Unexpected strict mode reserved word');
      done();
    });
  });
});